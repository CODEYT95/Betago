<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>í•™ìŠµê·¸ë£¹ ê°€ì… ìŠ¹ì¸</title>
    <link rel="stylesheet" type="text/css" th:href="@{/css/learning/group/educator/joinApprove.css}">
    <div th:replace="~{common/fragments/config :: configFragment}"></div>
</head>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        document.querySelectorAll('.checkbox, .checkbox2').forEach(function(checkbox) {
                checkbox.addEventListener('change', function() {
                    // ì„ íƒëœ ì²´í¬ë°•ìŠ¤ì˜ ë¶€ëª¨ ë…¸ë“œ (tr) ì°¾ê¸°
                    var row = this.closest('.tr-list');
                    var approveCheckbox = row.querySelector('.checkbox');
                    var rejectCheckbox = row.querySelector('.checkbox2');

                    // ë‘˜ ë‹¤ ì„ íƒë˜ì—ˆëŠ”ì§€ í™•ì¸
                    if (approveCheckbox.checked && rejectCheckbox.checked) {
                        alert('ë‘˜ ì¤‘ í•˜ë‚˜ë§Œ ì²´í¬ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
                        // í˜„ì¬ ì„ íƒí•œ ì²´í¬ë°•ìŠ¤ì˜ ì„ íƒì„ ì·¨ì†Œ
                        this.checked = false;
                    }
                });
            });
        // ì„ íƒëœ ê·¸ë£¹ ë²ˆí˜¸ë¥¼ ì €ì¥í•˜ëŠ” ë³€ìˆ˜
        let selectedGroupNo = null;

        const groupMenu = document.querySelector(".select-menu-group");
        const selectGroupBtn = groupMenu.querySelector(".select-btn-group");
        const groupOptions = groupMenu.querySelectorAll(".option");
        const groupSBtnText = groupMenu.querySelector(".sBtn-text");
        const hiddenInput = document.querySelector("#groupNoInput");  // ìˆ¨ê²¨ì§„ ì…ë ¥ í•„ë“œ

        selectGroupBtn.addEventListener("click", () => groupMenu.classList.toggle("active"));

        groupOptions.forEach(option => {
            option.addEventListener("click", () => {
                let selectedOption = option.querySelector(".option-text").innerText;
                groupSBtnText.innerText = selectedOption;
                selectedGroupNo = option.querySelector(".option-text").getAttribute("data-group-no");
                hiddenInput.value = selectedGroupNo;  // ìˆ¨ê²¨ì§„ ì…ë ¥ í•„ë“œì˜ ê°’ì„ ë°”ë¡œ ì„¤ì •
                groupMenu.classList.remove("active");
            });
        });
        document.addEventListener('click', function(event) {
        // í´ë¦­í•œ ëŒ€ìƒì´ í† ê¸€ ë²„íŠ¼ì´ë‚˜ í† ê¸€ ë©”ë‰´ ë‚´ë¶€ê°€ ì•„ë‹Œ ê²½ìš°
        if (!groupMenu.contains(event.target) && !selectGroupBtn.contains(event.target)) {
            groupMenu.classList.remove('active');  // í† ê¸€ ë©”ë‰´ ë‹«ê¸°
        }
    });
    });
</script>

<body>
<div th:replace="~{common/fragments/header :: headerFragment}"></div>
<div class="content">
    <div th:replace="~{common/sidebar/edu_sidebar :: edu_sidebarFragment}"></div>
    <div class="content-wrap">
        <div class="content-header">
            <div>
                <form style="display: contents;" th:action="@{/educator/group/approveList}" method="get">
                    <h3>í•™ìŠµ ê·¸ë£¹</h3>
                    <div class="select-menu-group">
                        <div class="select-btn-group">
                            <span class="sBtn-text">ì „ì²´</span>
                            <i class="bx bx-chevron-down"></i>
                        </div>
                        <ul class="options">
                            <li class="option">
                                <span class="option-text">ì „ì²´</span>
                            </li>
                            <li class="option" th:each="group : ${group_name}">
                                <span class="option-text" th:text="${group.group_name}" th:attr="data-group-no=${group.group_no}"></span>
                            </li>
                        </ul>
                    </div>
                    <input type="hidden" id="groupNoInput" name="group_no" value="">  <!-- ìˆ¨ê²¨ì§„ ì…ë ¥ í•„ë“œ ì¶”ê°€ -->
                    <button type="submit" class="search-btn">ì¡°íšŒ</button>
                </form>
            </div>
            <div>
                <h3>êµ¬ë… ê°€ëŠ¥ì¸ì›:<span>60ëª…</span></h3>
            </div>
            <div>
                <h3>ìŠ¹ì¸ ì¸ì›:<span>30ëª…</span></h3>
            </div>
        </div>
        <div class="main-table">
        <div class="table-wrap">
            <table >
                <caption class="table-title">ê·¸ë£¹ ê°€ì…ì‹ ì²­ ëª©ë¡ğŸ‘€</caption>
                <thead class="table-head">
                <tr>
                    <th class="t_no">ë²ˆí˜¸</th>
                    <th class="t_name">í•™ìƒì´ë¦„</th>
                    <th class="t_phone">í•™ìƒ ì—°ë½ì²˜</th>
                    <th class="t_date">ìŠ¹ì¸ ìš”ì²­ì¼ì</th>
                    <th class="t_approve">ìŠ¹ì¸</th>
                    <th class="t_reject">ê±°ë¶€</th>
                </thead>
                <tbody class="tbody-container">
                <th:block th:if="${check == null}">
                    <tr>
                        <td colspan="6">ê·¸ë£¹ì„ ì„ íƒ í›„ ì¡°íšŒ í•´ì£¼ì„¸ìš”.</td>
                    </tr>
                </th:block>
                <th:block th:if="${groupNo != null and #lists.isEmpty(GroupPageDTO.groupList)}">
                    <tr>
                        <td colspan="6">ê°€ì… ì‹ ì²­í•œ íšŒì›ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</td>
                    </tr>
                </th:block>
                <th:block th:if="${not #lists.isEmpty(GroupPageDTO.groupList)}">
                    <tr class="tr-list"  th:each="list, index : ${GroupPageDTO.groupList}">
                        <td class="list_no" th:text="${index.index + GroupPageDTO.startIndex + 1}"></td>
                        <td class="list_name" th:text="${list.member_name}"></td>
                        <td class="list_phone" th:text="${list.member_phone}"></td>
                        <td class="list_date" th:text="${list.approve_date}"></td>
                        <td class="list_approve" >
                            <label class="checkbox-wrap">
                                <input class="checkbox" type="checkbox" th:attr="data-approve-no=${list.member_no}">
                                <span class="checkmark"></span>
                            </label>
                        </td>
                        <td class="list_reject" >
                            <label class="checkbox-wrap2">
                                <input class="checkbox2" type="checkbox" th:attr="data-reject-no=${list.member_no}">
                                <span class="checkmark2"></span>
                            </label>
                        </td>
                    </tr>
                </th:block>
                </tbody>
            </table>
        </div>
        <th:block th:if="${check != null}">
        <div class="pagination">
            <div class="paging">
                <div class="text-center clearfix">
                    <div class="pagingNum">
                        <ul class="pagination-container" id="pagination">
                            <li th:if="${GroupPageDTO.startPage > 5}" class="page-item">
                                <a class="page-link" th:with="prevPage=${GroupPageDTO.startPage - 1}" th:href="@{/educator/group/approveList(page=${prevPage})}">Prev</a>
                            </li>
                            <li th:if="${pageNum > 0}" th:each="pageNum : ${#numbers.sequence(GroupPageDTO.startPage, GroupPageDTO.endPage)}" class="page-item">
                                <a th:href="@{/educator/group/approveList(page=${pageNum})}" class="page-link" th:classappend="${currentPage == pageNum} ? 'active-page' : ''"><span th:text="${pageNum}"></span></a>
                            </li>
                            <li th:if="${GroupPageDTO.endPage < GroupPageDTO.totalPages}" class="page-item">
                                <a class="page-link" th:with="nextPage=${GroupPageDTO.startPage + 5}" th:href="@{/educator/group/approveList(page=${nextPage})}">Next</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        </th:block>
        </div>
    </div>
</div>
<div th:replace="~{common/fragments/footer :: footerFragment}"></div>
</body>
</html>
